---
title: WMI を使用して Surface Dock 2 を管理する
description: この記事では、WMI を使用して、Surface Dock 2 デバイス間で最新のファームウェア、ポリシーの状態、関連データをリモートで監視および管理する方法について説明します。
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 6/25/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 0fef47cebfb4f520002ef4b08de43b54810fbf2f
ms.sourcegitcommit: 109d1d7608ac4667564fa5369e8722e569b8ea36
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2020
ms.locfileid: "10835645"
---
# WMI を使用して Surface Dock 2 を管理する

Windows Management Instrumentation (WMI) のサポートには、豊富な診断情報が用意されています。これにより、IT 管理者は、Surface Dock 2 デバイス間で最新のファームウェア、ポリシーの状態、関連データをリモートで監視および管理できるようになります。 WMI は、Windows PowerShell、System Center Operations Manager、その他のツールで使うことができます。 WMI の詳細については、「 [wmi を操作](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?view=powershell-5.1)する」を参照してください。 

WMI のサポートを有効にするには、 [Surface Dock 2 ドライバーとファームウェア](https://www.microsoft.com/download/details.aspx?id=101317)に移動して、適切なパッケージをダウンロードします。

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;バージョン # C1_x64.msi:**<br>

- Surface Pro (5 番目の Gen 以降)
- Surface Book (2 番目の Gen 以降)
- Surface Go (すべてのジェネレーション)
- Surface のノート Pc (すべての世代)

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;バージョン # C1_arm64.msi:** <br>

- Surface Pro X

## Surface Dock 2 での WMI の使用

1. Dock コンポーネントのすべてのインスタンスを列挙するには:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. WMI クラスのプロパティの説明にアクセスするには、コマンドプロンプトを開いて、「**プロパティ**」が表1に示されているプロパティの1つである場合に、wmi コマンドを入力します。

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **例:****バージョン**共通の Information MODEL (CIM) プロパティの説明にアクセスするには、次のように入力します。
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### 表 1. Surface Dock 2 WMI リファレンス

| プロパティ         | 型   | 期待される値                                                                                                                                                                                                            | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | String | コントローラー <br>"USB ハブ 1" <br>"USB Hub 2" <br>"ディスプレイポートハブ" <br>"Power Delivery Controller" <br>"オーディオコーデック" <br>"イーサネットコントローラー"                                                                         | 次のプロパティは、関連する Common Information Model (CIM) クラスデータに対応するデバイスコンポーネントの特定の名前を一覧表示します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | String | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | 次のプロパティには、特定のデバイスコンポーネントが属している dock デバイスの名前が含まれています。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | String | 数値のみを含む12桁のシリアル値                                                                                                                                                           | 次のプロパティは、接続されている dock デバイスのシリアル番号を記録します。 このシリアル番号は、すべてのコンポーネントが同じ dock デバイスに属している場合とまったく同じです。 参照の場合、このシリアル番号は、Surface Dock 自体の下側に物理的にあります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | uint16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | 次のプロパティは、ゼロ (0) から始まり、カウントアップする一意の Id です。 この変数は、列挙された WMI インスタンスの番号付けに使われます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | String | 正しい <br>"PendingDockReattach" <br>まし                                                                                                                                                                             | 次のプロパティは、問題のデバイスコンポーネントに対して最後に試行されたコンポーネントのファームウェア更新プログラム (CFU) の状態を詳しく示しています。 可能な値は **、Success、** **Dock の再アタッチ、** および**失敗した**値です。<br><br><br>- **成功**以前に追加された新しいファームウェアが正常に適用されたことを示します。<br>- **保留中の dock**の再装着デバイスコンポーネントに対して新しい更新プログラムが保留中であることを示します。ユーザーは、新しい更新プログラムを適用するために Dock の Surface コネクタをデタッチして再接続する必要があります。<br>- **Failed**は、cfu プロセス中に正当なエラーが発生したか、予期されたバージョンで周辺機器が起動しなかったことを示します。 失敗し**た**場合は、デバイスが動作していないことを示していますが、デバイスを更新しようとしたときにエラーが発生しました。 その場合は、以前のファームウェアの実行が続行されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | String | な <br>無効に                                                                                                                                                                                                     | 次のプロパティは、デバイスコンポーネントの現在の Surface Enterprise Management Mode (SEMM) ポリシーを示します。 指定可能な値: **Enabled**および**Disabled。**<br><br><br>- **Enabled**は、ホストデバイスがデバイスコンポーネントにアクセスして使用できるように、semm システムが許可したことを示します。<br>- [**無効**] は、semm システムが許可されていないことを示します。これにより、ホストコンピューターがデバイスコンポーネントにアクセスして使用できなくなります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ProductId        | String [] | 16進数文字列のリスト。各範囲は "0x0000" から "0xFFFF" まで                                                                                                                                                        | 次のプロパティは、デバイスコンポーネントの製品 Id (PID) を分類します。 複数の PID を一覧表示することもできます。 たとえば、USB ハブの場合、Super Speed (SS) と高速 (HS) の両方のデバイスは、単数形の "ハブ" に lumped されます。 そのため、この配列内には2つの Pid が一覧表示されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 状態           | String | OK] <br>外し <br>誤差 <br>失わ <br>"DeviceHandleInUse" <br>無効に <br>"NotSupportedByWmi"                                                                                                             | 次のプロパティは、ホストコンピューターへの Dock の接続状態を示します。 可能な値は、 **OK、** **Disconnected、** **Error、** **Missing、** **Devicehandleinuse、**  **Disabled、** **notsupportedbywmi です。** <br>- **[OK]** は、デバイスがホストコンピューターに正常に接続されていて、問題が発生しないことを示します。そのため、この機能は使用できません。 <br>- [**切断**] は、すべてのデバイスコンポーネントの接続を提供する Surface コネクタが現在ホストコンピューターにアタッチされていないことを示します。 <br>- **エラー**は、デバイスインスタンスの潜在的な問題を示しています。また、デバイスインターフェイスには、デバイスマネージャーで黄色の感嘆符でラベル付けされた可能性が高い問題があります。発生したエラーの種類の詳細については、 **StatusCode**プロパティを確認してください。 <br>- [**存在**しない] は、デバイスがホストコンピューターで列挙されているはずですが、何らかの理由で列挙されたことを示します。 この間違った状況を示すため、 **StatusCode**プロパティは24の値を保持します。<br>- **Devicehandleinuse**は、別のプロセスが現在デバイスと通信していることを示します。これにより、この Windows Management INSTRUMENTATION (WMI) インスタンスプロバイダーは通信要求から処理されません。 WMI コマンドをもう一度実行してみてください。 <br> - [**無効**] は、現在の Surface Enterprise Management MODE (semm) ポリシーが許可されていないことを示します。そのため、ホストコンピューターはデバイスコンポーネントにアクセスして使うことができなくなります。 詳細については、 **Policystate**プロパティフィールドを参照してください。<br>- **Notsupportedbywmi**は、接続された dock がこの WMI プロバイダーによって現在サポートされていないことを示します。 この状態は、この WMI インスタンスプロバイダーで現在サポートされていない Surface Dock 1 に対して表示されます。|
| StatusCode       | uint32 | CIM_LogicalDevice WMI クラス ( *cimwin32*内) から取得した[デバイスマネージャーのエラーコード](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) | 次のプロパティは、指定された dock コンポーネントのデバイスマネージャーエラーコードを提供します。 値が0の場合は、dock コンポーネントが正常に動作していることを示します。値が0より大きい場合は、dock コンポーネントの問題または発生する可能性のあるエラーを示します。 Dock コンポーネントは、いくつかのデバイスインターフェイスで列挙される可能性があるため、デバイスマネージャーの追加のエラーコードが表示されることがあります。 このプロパティフィールドは、複数のエラーコードを一覧表示します。 デバイスマネージャーは、特定のエラーコードが発生した場合にのみ、デバイスに黄色の感嘆符を付けます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | String | "0x0000" から "0xFFFF" までの範囲の16進数の文字列                                                                                                                                                                        | 次のプロパティは、デバイスコンポーネントの特定のベンダー Id (VID) を示しています。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| バージョン          | String | 次のような形式のバージョン文字列。 "x.y"、x、y、z は数値型の値です。                                                                                                                            | 次のプロパティでは、デバイスコンポーネントで現在実行されているファームウェアの現在のバージョンを指定します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## 詳細情報

- [SEMM での Secure Surface Dock 2 ポート](secure-surface-dock-ports-semm.md)
- [Surface Dock 2 の新機能](surface-dock-whats-new.md)
- [デバイスマネージャーのエラーコード](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [WMI の操作](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?view=powershell-5.1)
